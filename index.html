<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link href="https://fonts.googleapis.com/css?family=Dr+Sugiyama" rel="stylesheet">
  <title>Sketchy-Etch</title>
  <link rel="stylesheet" href="style.css">
</head>
<body onresize="drawPage()">
  <div id="header">
    <div id="ribbon">
      <div class='wrapper'>
        <button title="Clear screen + option to change grid density" onclick="reset()" id="reset">RESET</button>
      </div>
      <div class='wrapper' id="middleWrapper">
        <div id="titleContainer">
          <h1 id="title">Sketchy - Etch</h1>
          <div id="tm"> &trade;</div>
        </div>
        <div id="sliderContainer">
          <input title="Adjust coverage weight" type="range" min="10" max="100" value="25" class="slider" id="myRange">
          <p id="sliderLabel">WEIGHT</p>
        </div>
      </div>
      <div class='wrapper'>
        <label class="switch">
          <input type="checkbox">
          <span title="Toggle mode: monochrome or random color" class="toggle round"></span>
        </label>
      </div>
    </div>
  </div>
  <div id="grid">
  </div>

<script>

  function createSquares() {
    numSquares = gridDimension * gridDimension;
    for (let i = 0; i < numSquares; i++) {
      const square = document.createElement('div');
      square.classList.add('square');
      grid.appendChild(square);
    }
  }

  function removeSquares() {
    let elements = document.getElementsByClassName('square');
    while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
    }
  }

  function calcSizes() {
    gridHeightLimit = window.innerHeight * 0.8;
    gridWidthLimit = window.innerWidth * 0.95;
    gridLimit = gridHeightLimit;
    if (gridLimit > gridWidthLimit) {gridLimit = gridWidthLimit;} // Set grid side-length to less than smallest window dimension (x or y)
    gridSize = gridLimit.toString() + "px";

    headerLimit = Math.floor(window.innerHeight * 0.15);
    headerHeight = headerLimit.toString() + "px";

    headerWidth = (gridLimit + 8).toString() + "px"; // Add 8px to header width to account for grid drop shadow
    ribbonWidth = (gridLimit + 4).toString() + "px"; // Subtract 4px from ribbon width to account for border

    let rowHeightNum = (gridLimit - (gridDimension - 1))/ gridDimension; // Account for 1px grid-gap
    rowHeight = rowHeightNum.toString() + "px";

    gridColumns = "repeat(" + gridDimension.toString() + ", 1fr)"
  }

  function drawPage() {
    calcSizes();
    document.getElementById('header').style.height = headerHeight;
    document.getElementById('header').style.width = headerWidth;
    document.getElementById('ribbon').style.width = ribbonWidth;
    document.getElementById('grid').style.width = gridSize;
    document.getElementById('grid').style.gridAutoRows = rowHeight;
    document.getElementById('grid').style.gridTemplateColumns = gridColumns;
  }

  function reset() {
    let oldGrid = gridDimension;
    do {
      gridDimension = window.prompt("Change number of squares per side? (16 - 64)", oldGrid), 10;
      if (gridDimension === null) {return;} // Enables cancel button on prompt window
      else {gridDimension = parseInt(gridDimension);}
    } while(isNaN(gridDimension) || gridDimension > 64 || gridDimension < 16);

    removeSquares();
    createSquares();
    drawPage();
  }

  let gridDimension = 32;
  let numSquares = 0;
  let gridWidthLimit = 0;
  let gridHeightLimit = 0;
  let gridLimit = 0;
  let rowHeight = "not set";
  let gridSize = "not set";
  let headerLimit = 0;
  let headerHeight = "not set";
  let headerWidth = "not set";
  let ribbonWidth = "not set";
  let gridColumns = "not set";

  createSquares();
  drawPage();

</script>

</body>
</html>
